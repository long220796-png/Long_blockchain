{"ast":null,"code":"var _jsxFileName = \"D:\\\\payment\\\\frontend\\\\src\\\\pages\\\\DonateDetail.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { ethers } from \"ethers\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TOKEN_ADDRESS = \"0x0c03Ba43E611a6A83A51FF0eB878D8b68c1240C2\";\nconst PROJECT_WALLET = \"0x9d5f77169ead4C8C96D63993eD9ef6239092c416\";\nconst ERC20_ABI = [\"function transfer(address to, uint256 amount) public returns (bool)\", \"function decimals() view returns (uint8)\"];\nfunction DonateDetail({\n  projectName\n}) {\n  _s();\n  const [donorName, setDonorName] = useState(\"\");\n  const [amount, setAmount] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [txHash, setTxHash] = useState(\"\");\n  const [error, setError] = useState(\"\");\n  const handleDonate = async () => {\n    setError(\"\");\n    setTxHash(\"\");\n    if (!window.ethereum) {\n      setError(\"Vui lòng cài MetaMask\");\n      return;\n    }\n    if (!donorName || !amount) {\n      setError(\"Vui lòng nhập đầy đủ thông tin\");\n      return;\n    }\n    try {\n      setLoading(true);\n      const provider = new ethers.BrowserProvider(window.ethereum);\n      const signer = await provider.getSigner();\n      const contract = new ethers.Contract(TOKEN_ADDRESS, ERC20_ABI, signer);\n      const decimals = await contract.decimals();\n      const value = ethers.parseUnits(amount, decimals);\n\n      /**\r\n       * ⚠️ HEDERA ERC20 KHÔNG HỖ TRỢ MEMO\r\n       * Memo (donor + project) được lưu ở frontend / DB\r\n       * Dùng transaction hash để đối soát trên HashScan\r\n       */\n      const memo = `Người quyên góp: ${donorName} | Dự án: ${projectName}`;\n      console.log(\"MEMO:\", memo);\n      const tx = await contract.transfer(PROJECT_WALLET, value);\n      await tx.wait();\n      setTxHash(tx.hash);\n    } catch (err) {\n      console.error(err);\n      setError(\"Giao dịch thất bại\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: 500,\n      margin: \"0 auto\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Quy\\xEAn g\\xF3p cho d\\u1EF1 \\xE1n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"D\\u1EF1 \\xE1n:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 10\n      }, this), \" \", projectName]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      placeholder: \"T\\xEAn ng\\u01B0\\u1EDDi quy\\xEAn g\\xF3p\",\n      value: donorName,\n      onChange: e => setDonorName(e.target.value),\n      style: {\n        width: \"100%\",\n        marginBottom: 10\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"number\",\n      placeholder: \"S\\u1ED1 l\\u01B0\\u1EE3ng MTK\",\n      value: amount,\n      onChange: e => setAmount(e.target.value),\n      style: {\n        width: \"100%\",\n        marginBottom: 10\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleDonate,\n      disabled: loading,\n      children: loading ? \"Đang xử lý...\" : \"Xác nhận quyên góp\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), txHash && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Tx Hash:\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n        href: `https://hashscan.io/testnet/transaction/${txHash}`,\n        target: \"_blank\",\n        rel: \"noreferrer\",\n        children: \"Xem tr\\xEAn HashScan\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: \"red\"\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n}\n_s(DonateDetail, \"piRvhnrEELflUTtxDhDS9kHu0Y4=\");\n_c = DonateDetail;\nexport default DonateDetail;\nvar _c;\n$RefreshReg$(_c, \"DonateDetail\");","map":{"version":3,"names":["React","useState","ethers","jsxDEV","_jsxDEV","TOKEN_ADDRESS","PROJECT_WALLET","ERC20_ABI","DonateDetail","projectName","_s","donorName","setDonorName","amount","setAmount","loading","setLoading","txHash","setTxHash","error","setError","handleDonate","window","ethereum","provider","BrowserProvider","signer","getSigner","contract","Contract","decimals","value","parseUnits","memo","console","log","tx","transfer","wait","hash","err","style","maxWidth","margin","children","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","onChange","e","target","width","marginBottom","onClick","disabled","href","rel","color","_c","$RefreshReg$"],"sources":["D:/payment/frontend/src/pages/DonateDetail.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { ethers } from \"ethers\";\r\n\r\nconst TOKEN_ADDRESS = \"0x0c03Ba43E611a6A83A51FF0eB878D8b68c1240C2\";\r\nconst PROJECT_WALLET = \"0x9d5f77169ead4C8C96D63993eD9ef6239092c416\";\r\n\r\nconst ERC20_ABI = [\r\n  \"function transfer(address to, uint256 amount) public returns (bool)\",\r\n  \"function decimals() view returns (uint8)\"\r\n];\r\n\r\nfunction DonateDetail({ projectName }) {\r\n  const [donorName, setDonorName] = useState(\"\");\r\n  const [amount, setAmount] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [txHash, setTxHash] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const handleDonate = async () => {\r\n    setError(\"\");\r\n    setTxHash(\"\");\r\n\r\n    if (!window.ethereum) {\r\n      setError(\"Vui lòng cài MetaMask\");\r\n      return;\r\n    }\r\n\r\n    if (!donorName || !amount) {\r\n      setError(\"Vui lòng nhập đầy đủ thông tin\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      const provider = new ethers.BrowserProvider(window.ethereum);\r\n      const signer = await provider.getSigner();\r\n      const contract = new ethers.Contract(\r\n        TOKEN_ADDRESS,\r\n        ERC20_ABI,\r\n        signer\r\n      );\r\n\r\n      const decimals = await contract.decimals();\r\n      const value = ethers.parseUnits(amount, decimals);\r\n\r\n      /**\r\n       * ⚠️ HEDERA ERC20 KHÔNG HỖ TRỢ MEMO\r\n       * Memo (donor + project) được lưu ở frontend / DB\r\n       * Dùng transaction hash để đối soát trên HashScan\r\n       */\r\n      const memo = `Người quyên góp: ${donorName} | Dự án: ${projectName}`;\r\n\r\n      console.log(\"MEMO:\", memo);\r\n\r\n      const tx = await contract.transfer(PROJECT_WALLET, value);\r\n      await tx.wait();\r\n\r\n      setTxHash(tx.hash);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError(\"Giao dịch thất bại\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ maxWidth: 500, margin: \"0 auto\" }}>\r\n      <h2>Quyên góp cho dự án</h2>\r\n\r\n      <p><b>Dự án:</b> {projectName}</p>\r\n\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Tên người quyên góp\"\r\n        value={donorName}\r\n        onChange={(e) => setDonorName(e.target.value)}\r\n        style={{ width: \"100%\", marginBottom: 10 }}\r\n      />\r\n\r\n      <input\r\n        type=\"number\"\r\n        placeholder=\"Số lượng MTK\"\r\n        value={amount}\r\n        onChange={(e) => setAmount(e.target.value)}\r\n        style={{ width: \"100%\", marginBottom: 10 }}\r\n      />\r\n\r\n      <button onClick={handleDonate} disabled={loading}>\r\n        {loading ? \"Đang xử lý...\" : \"Xác nhận quyên góp\"}\r\n      </button>\r\n\r\n      {txHash && (\r\n        <p>\r\n          Tx Hash:{\" \"}\r\n          <a\r\n            href={`https://hashscan.io/testnet/transaction/${txHash}`}\r\n            target=\"_blank\"\r\n            rel=\"noreferrer\"\r\n          >\r\n            Xem trên HashScan\r\n          </a>\r\n        </p>\r\n      )}\r\n\r\n      {error && <p style={{ color: \"red\" }}>{error}</p>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DonateDetail;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}